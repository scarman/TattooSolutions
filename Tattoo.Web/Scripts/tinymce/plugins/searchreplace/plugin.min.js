(function(){function n(n,t,i,r,u){function v(n,t){var i,r;if(t=t||0,!n[0])throw"findAndReplaceDOMText cannot handle zero-length matches";if(i=n.index,t>0){if(r=n[t],!r)throw"Invalid capture group";i+=n[0].indexOf(r);n[0]=r}return[i,i+n[0].length,[n[0]]]}function y(n){var t;if(n.nodeType===3)return n.data;if(c[n.nodeName]&&!o[n.nodeName])return"";if(t="",(o[n.nodeName]||l[n.nodeName])&&(t+="\n"),n=n.firstChild)do t+=y(n);while(n=n.nextSibling);return t}function p(n,t,i){var e,s,v,h,a=[],u=0,r=n,f=t.shift(),y=0;n:for(;;){if((o[r.nodeName]||l[r.nodeName])&&u++,r.nodeType===3&&(!s&&r.length+u>=f[1]?(s=r,h=f[1]-u):e&&a.push(r),!e&&r.length+u>f[0]&&(e=r,v=f[0]-u),u+=r.length),e&&s){if(r=i({startNode:e,startNodeIndex:v,endNode:s,endNodeIndex:h,innerNodes:a,match:f[2],matchIndex:y}),u-=s.length-h,e=null,s=null,a=[],f=t.shift(),y++,!f)break}else if((!c[r.nodeName]||o[r.nodeName])&&r.firstChild){r=r.firstChild;continue}else if(r.nextSibling){r=r.nextSibling;continue}for(;;)if(r.nextSibling){r=r.nextSibling;break}else if(r.parentNode!==n)r=r.parentNode;else break n}}function w(n){var t,i;return typeof n!="function"?(i=n.nodeType?n:f.createElement(n),t=function(n,t){var r=i.cloneNode(!1);return r.setAttribute("data-mce-index",t),n&&r.appendChild(f.createTextNode(n)),r}):t=n,function(n){var o,s,i,u=n.startNode,e=n.endNode,h=n.matchIndex,r,a,p,w,c,b,l,v,y;if(u===e)return r=u,i=r.parentNode,n.startNodeIndex>0&&(o=f.createTextNode(r.data.substring(0,n.startNodeIndex)),i.insertBefore(o,r)),a=t(n.match[0],h),i.insertBefore(a,r),n.endNodeIndex<r.length&&(s=f.createTextNode(r.data.substring(n.endNodeIndex)),i.insertBefore(s,r)),r.parentNode.removeChild(r),a;for(o=f.createTextNode(u.data.substring(0,n.startNodeIndex)),s=f.createTextNode(e.data.substring(n.endNodeIndex)),p=t(u.data.substring(n.startNodeIndex),h),w=[],c=0,b=n.innerNodes.length;c<b;++c)l=n.innerNodes[c],v=t(l.data,h),l.parentNode.replaceChild(v,l),w.push(v);return y=t(e.data.substring(0,n.endNodeIndex),h),i=u.parentNode,i.insertBefore(o,u),i.insertBefore(p,u),i.removeChild(u),i=e.parentNode,i.insertBefore(y,e),i.insertBefore(s,e),i.removeChild(e),y}}var s,e=[],h,a=0,f,o,c,l;if(f=t.ownerDocument,o=u.getBlockElements(),c=u.getWhiteSpaceElements(),l=u.getShortEndedElements(),h=y(t),h){if(n.global)while(s=n.exec(h))e.push(v(s,r));else s=h.match(n),e.push(v(s,r));return e.length&&(a=e.length,p(t,e,w(i))),a}}function t(t){function f(){function e(){n.statusbar.find("#next").disabled(!u(r+1).length);n.statusbar.find("#prev").disabled(!u(r-1).length)}function o(){tinymce.ui.MessageBox.alert("Could not find the specified string.",function(){n.find("#find")[0].focus()})}var f={},n=tinymce.ui.Factory.create({type:"window",layout:"flex",pack:"center",align:"center",onClose:function(){t.focus();i.done()},onSubmit:function(t){var l,h,s,c;if(t.preventDefault(),h=n.find("#case").checked(),c=n.find("#words").checked(),s=n.find("#find").value(),!s.length){i.done(!1);n.statusbar.items().slice(1).disabled(!0);return}if(f.text==s&&f.caseState==h&&f.wholeWord==c){if(u(r+1).length===0){o();return}i.next();e();return}l=i.find(s,h,c);l||o();n.statusbar.items().slice(1).disabled(l===0);e();f={text:s,caseState:h,wholeWord:c}},buttons:[{text:"Find",onclick:function(){n.submit()}},{text:"Replace",disabled:!0,onclick:function(){i.replace(n.find("#replace").value())||(n.statusbar.items().slice(1).disabled(!0),r=-1,f={})}},{text:"Replace all",disabled:!0,onclick:function(){i.replace(n.find("#replace").value(),!0,!0);n.statusbar.items().slice(1).disabled(!0);f={}}},{type:"spacer",flex:1},{text:"Prev",name:"prev",disabled:!0,onclick:function(){i.prev();e()}},{text:"Next",name:"next",disabled:!0,onclick:function(){i.next();e()}}],title:"Find and replace",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"find",size:40,label:"Find",value:t.selection.getNode().src},{type:"textbox",name:"replace",size:40,label:"Replace with"},{type:"checkbox",name:"case",text:"Match case",label:" "},{type:"checkbox",name:"words",text:"Whole words",label:" "}]}}).renderTo().reflow()}function e(n){var t=n.getAttribute("data-mce-index");return typeof t=="number"?""+t:t}function c(r){var f,u;return u=t.dom.create("span",{"data-mce-bogus":1}),u.className="mce-match-marker",f=t.getBody(),i.done(!1),n(r,f,u,!1,t.schema)}function s(n){var t=n.parentNode;n.firstChild&&t.insertBefore(n.firstChild,n);n.parentNode.removeChild(n)}function u(n){var i,f=[],r,u;if(i=tinymce.toArray(t.getBody().getElementsByTagName("span")),i.length)for(r=0;r<i.length;r++)(u=e(i[r]),u!==null&&u.length)&&u===n.toString()&&f.push(i[r]);return f}function o(n){var i=r,e=t.dom,f;return(n=n!==!1,n?i++:i--,e.removeClass(u(r),"mce-match-marker-selected"),f=u(i),f.length)?(e.addClass(u(i),"mce-match-marker-selected"),t.selection.scrollIntoView(f[0]),i):-1}function h(n){n.parentNode.removeChild(n)}var i=this,r=-1;i.init=function(n){n.addMenuItem("searchreplace",{text:"Find and replace",shortcut:"Ctrl+F",onclick:f,separator:"before",context:"edit"});n.addButton("searchreplace",{tooltip:"Find and replace",shortcut:"Ctrl+F",onclick:f});n.addCommand("SearchReplace",f);n.shortcuts.add("Ctrl+F","",f)};i.find=function(n,t,i){n=n.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");n=i?"\\b"+n+"\\b":n;var u=c(new RegExp(n,t?"g":"gi"));return u&&(r=-1,r=o(!0)),u};i.next=function(){var n=o(!0);n!==-1&&(r=n)};i.prev=function(){var n=o(!1);n!==-1&&(r=n)};i.replace=function(n,f,o){var c,l,b,v,y,p=r,w,a;for(f=f!==!1,b=t.getBody(),l=tinymce.toArray(b.getElementsByTagName("span")),c=0;c<l.length;c++)if(a=e(l[c]),a!==null&&a.length)if(v=y=parseInt(a,10),o||v===r){for(n.length?(l[c].firstChild.nodeValue=n,s(l[c])):h(l[c]);l[++c];)if(v=e(l[c]),a!==null&&a.length)if(v===y)h(l[c]);else{c--;break}f&&p--}else y>r&&l[c].setAttribute("data-mce-index",y-1);return t.undoManager.add(),r=p,f?(w=u(p+1).length>0,i.next()):(w=u(p-1).length>0,i.prev()),!o&&w};i.done=function(n){for(var o,h,c,f,u=tinymce.toArray(t.getBody().getElementsByTagName("span")),i=0;i<u.length;i++)c=e(u[i]),c!==null&&c.length&&(c===r.toString()&&(o||(o=u[i].firstChild),h=u[i].firstChild),s(u[i]));if(o&&h)return f=t.dom.createRng(),f.setStart(o,0),f.setEnd(h,h.data.length),n!==!1&&t.selection.setRng(f),f}}tinymce.PluginManager.add("searchreplace",t)})();
/*
//# sourceMappingURL=plugin.min.js.map
*/