tinymce.PluginManager.add("template",function(n){function r(t){return function(){var i=n.settings.templates;typeof i=="string"?tinymce.util.XHR.send({url:i,success:function(n){t(tinymce.util.JSON.parse(n))}}):t(i)}}function u(t){function f(t){function f(t){var u,i;t.indexOf("<html>")==-1&&(u="",tinymce.each(n.contentCSS,function(t){u+='<link type="text/css" rel="stylesheet" href="'+n.documentBaseURI.toAbsolute(t)+'">'}),t="<!DOCTYPE html><html><head>"+u+"<\/head><body>"+t+"<\/body><\/html>");t=e(t,"template_preview_replace_values");i=r.find("iframe")[0].getEl().contentWindow.document;i.open();i.write(t);i.close()}var u=t.control.value();u.url?tinymce.util.XHR.send({url:u.url,success:function(n){i=n;f(i)}}):(i=u.content,f(i));r.find("#description")[0].text(t.control.value().description)}var r,u=[],i;if(!t||t.length===0){n.windowManager.alert("No templates defined");return}tinymce.each(t,function(n){u.push({selected:!u.length,text:n.title,value:{url:n.url,content:n.content,description:n.description}})});r=n.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:u,onselect:f}}]},{type:"label",name:"description",label:"Description",text:" "},{type:"iframe",flex:1,border:1}],onsubmit:function(){o(!1,i)},width:n.getParam("template_popup_width",600),height:n.getParam("template_popup_height",500)});r.find("listbox")[0].fire("select")}function i(t,i){function r(n,t){if(n=""+n,n.length<t)for(var i=0;i<t-n.length;i++)n="0"+n;return n}var u="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),f="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),e="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),o="January February March April May June July August September October November December".split(" ");return i=i||new Date,t=t.replace("%D","%m/%d/%Y"),t=t.replace("%r","%I:%M:%S %p"),t=t.replace("%Y",""+i.getFullYear()),t=t.replace("%y",""+i.getYear()),t=t.replace("%m",r(i.getMonth()+1,2)),t=t.replace("%d",r(i.getDate(),2)),t=t.replace("%H",""+r(i.getHours(),2)),t=t.replace("%M",""+r(i.getMinutes(),2)),t=t.replace("%S",""+r(i.getSeconds(),2)),t=t.replace("%I",""+((i.getHours()+11)%12+1)),t=t.replace("%p",""+(i.getHours()<12?"AM":"PM")),t=t.replace("%B",""+n.translate(o[i.getMonth()])),t=t.replace("%b",""+n.translate(e[i.getMonth()])),t=t.replace("%A",""+n.translate(f[i.getDay()])),t=t.replace("%a",""+n.translate(u[i.getDay()])),t.replace("%%","%")}function f(i){var u=n.dom,r=n.getParam("template_replace_values");t(u.select("*",i),function(n){t(r,function(t,i){u.hasClass(n,i)&&typeof r[i]=="function"&&r[i](n)})})}function e(i,r){return t(n.getParam(r),function(n,t){typeof n!="function"&&(i=i.replace(new RegExp("\\{\\$"+t+"\\}","g"),n))}),i}function o(r,u){function c(n,t){return new RegExp("\\b"+t+"\\b","g").test(n.className)}var o,s,h=n.dom,l=n.selection.getContent();u=e(u,"template_replace_values");o=h.create("div",null,u);s=h.select(".mceTmpl",o);s&&s.length>0&&(o=h.create("div",null),o.appendChild(s[0].cloneNode(!0)));t(h.select("*",o),function(t){c(t,n.getParam("template_cdate_classes","cdate").replace(/\s+/g,"|"))&&(t.innerHTML=i(n.getParam("template_cdate_format",n.getLang("template.cdate_format"))));c(t,n.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(t.innerHTML=i(n.getParam("template_mdate_format",n.getLang("template.mdate_format"))));c(t,n.getParam("template_selected_content_classes","selcontent").replace(/\s+/g,"|"))&&(t.innerHTML=l)});f(o);n.execCommand("mceInsertContent",!1,o.innerHTML);n.addVisual()}var t=tinymce.each;n.addCommand("mceInsertTemplate",o);n.addButton("template",{title:"Insert template",onclick:r(u)});n.addMenuItem("template",{text:"Insert template",onclick:r(u),context:"insert"});n.on("PreProcess",function(r){var u=n.dom;t(u.select("div",r.node),function(r){u.hasClass(r,"mceTmpl")&&(t(u.select("*",r),function(t){u.hasClass(t,n.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(t.innerHTML=i(n.getParam("template_mdate_format",n.getLang("template.mdate_format"))))}),f(r))})})});
/*
//# sourceMappingURL=plugin.min.js.map
*/